


<!DOCTYPE html>

<html lang="en-GB">
    
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="description" content="This is the description of 3 May 2018" />
    <!-- eGov Meta Data  -->
    <!-- this will make your html5 page invalid! -->
    <meta name="DC.Subject" content="">
    <meta name="DC.Date" content="">
    <meta name="DC.Creator" content="Amber Valley Borough Council">
    <meta name="DC.Publisher" content="Amber Valley Borough Council">
    <meta name="DC.Title" content="3 May 2018 ">
    <!-- end eGov -->


    <title>3 May 2018</title>

    <link rel="stylesheet" href="/css/avmain.css">
    <link rel="stylesheet" href="/css/contourForms.css">

    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css" />
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/bootstrap-accessibility.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
    <script src="/scripts/bootstrap-accessibility.min.js"></script>

    <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap.min.js"></script>
    
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>
    <script src="//cdn.datatables.net/plug-ins/1.10.19/sorting/datetime-moment.js"></script>

    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/mvc/5.1/jquery.validate.unobtrusive.min.js"></script>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
      integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
      integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg==" crossorigin=""></script>
      
    <link rel="stylesheet" href="/scripts/leaflet-measure/dist/leaflet-measure.css">

    <script src="/scripts/dist/bundle.js"></script>
    <script src="/scripts/leaflet-measure/dist/leaflet-measure.js"></script>
    
    <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js"></script>
    <link href="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css" rel="stylesheet" />

    <script src="https://unpkg.com/&#64;mapbox/leaflet-pip&#64;latest/leaflet-pip.js"></script>

    <script src="/scripts/spin.js"></script>

    <link href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.css" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.js"></script>
    <script src="/js/forms-propertylookup.js"></script>

    <link href="/css/glyphicons.css" rel="stylesheet" />
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2965051-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-2965051-1');
    </script>
    
    <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="91ff495d-2161-415f-b4a0-9f3d07ca2de0" async></script>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/images/fav-icons/apple-touch-icon.png?v=lk9w5JY0zl">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/fav-icons/favicon-32x32.png?v=lk9w5JY0zl">
    <link rel="icon" type="image/png" sizes="194x194" href="/images/fav-icons/favicon-194x194.png?v=lk9w5JY0zl">
    <link rel="icon" type="image/png" sizes="192x192" href="/images/fav-icons/android-chrome-192x192.png?v=lk9w5JY0zl">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/fav-icons/favicon-16x16.png?v=lk9w5JY0zl">
    <link rel="shortcut icon" href="/images/fav-icons/favicon.ico?v=lk9w5JY0zl">
    <meta name="msapplication-TileColor" content="#008080">
    <meta name="msapplication-TileImage" content="/images/fav-icons/mstile-144x144.png?v=lk9w5JY0zl">
    <meta name="msapplication-config" content="/images/fav-icons/browserconfig.xml?v=lk9w5JY0zl">
    <meta name="theme-color" content="#ffffff">
    
    
    
    
    <script type="text/javascript" src="https://www.browsealoud.com/plus/scripts/ba.js"></script>

    <script>
    
        //var avGlobalIsIntranet = window.location.hostname.toLowerCase().includes("avbc.gov.uk");
        
        /*#####################
        Additional jQuery (required)
        #####################*/
        $(document).ready(function () {

            var clickEvent = false;
            $('#myCarousel').carousel({
                interval: 4000
            }).on('click', '.list-group li', function () {
                clickEvent = true;
                $('.list-group li').removeClass('active');
                $(this).addClass('active');
            }).on('slid.bs.carousel', function (e) {
                if (!clickEvent) {
                    var count = $('.list-group').children().length - 1;
                    var current = $('.list-group li.active');
                    current.removeClass('active').next().addClass('active');
                    var id = parseInt(current.data('slide-to'));
                    if (count == id) {
                        $('.list-group li').first().addClass('active');
                    }
                }
                clickEvent = false;
            });
            $('#btnA2Z').click(function () {
                $('#searchPopout').hide();
                $('#menuPopout').hide();
                if ($('#a2zPopout').css('display') == 'none' || $('#a2zPopout').css("visibility") == "hidden") {
                    $('#a2zPopout').slideDown("slow");
                }
                else {
                    $('#a2zPopout').slideUp("slow");
                }

            });
            $('#btnMenu').click(function () {
                //closeAllPopouts();
                $('#searchPopout').hide();
                $('#a2zPopout').hide();
                if ($('#menuPopout').css('display') == 'none' || $('#menuPopout').css("visibility") == "hidden") {
                    $('#menuPopout').slideDown("slow");
                }
                else {
                    $('#menuPopout').slideUp("slow");
                }
            });
            $('#btnOpenSearch').click(function () {
                $('#a2zPopout').hide();
                $('#menuPopout').hide();
                if ($('#searchPopout').css('display') == 'none' || $('#searchPopout').css("visibility") == "hidden") {
                    $('#searchPopout').slideDown("slow");
                }
                else {
                    $('#searchPopout').slideUp("slow");
                }
            });
            $('.close').click(function () {
                $('#searchPopout').hide();
                $('#a2zPopout').hide();
                $('#menuPopout').hide();
            });
            

        })
        $(window).load(function () {
            var boxheight = $('#myCarousel .carousel-inner').innerHeight();
            var itemlength = $('#myCarousel .item').length;
            var triggerheight = Math.round(boxheight / itemlength + 1);

            $('#myCarousel .list-group-item').outerHeight(triggerheight);
        });
        
        $.fn.dataTable.moment( 'DD-MM-YYYY' );
        $.fn.dataTable.moment( 'DD/MM/YYYY' );
    </script>
    
</head>

    <body>

        <header>
            <div class="container">
                <div class="row">
                    <div class="col-sm-8">
		                <a href="/Default.aspx"><p style="display:none">home link</p><img src="/images/logo.jpg" alt="council logo" style="width:277px;height:69px"></a>
                    </div>
                    <div class="col-sm-4">
                    </div>    
                </div>
            </div>
        </header>

        <div class="navigationMenu" style="">
            <nav class="navbar navbar-default"  style="text-align:right">
                <div class="container-fluid" style="text-align:right; ">
                    <div class="navbar-header" style="text-align:right;width:100%; ">
                            <div style="float:left;" class="hidden-sm hidden-xs">
                                    <ul class="breadcrumb" aria-label="Breadcrumb">
        <li><a href="/"><span class="forceBlack">Home</span></a></li>
            <li class=""><a href="/councillors-and-elections/"><span class="forceBlack">Councillors and elections</span></a></li>
            <li class=""><a href="/councillors-and-elections/elections/"><span class="forceBlack">Elections</span></a></li>
            <li class=""><a href="/councillors-and-elections/elections/local-elections/"><span class="forceBlack">Local elections</span></a></li>
            <li class=""><a href="/councillors-and-elections/elections/local-elections/borough-election-results/"><span class="forceBlack">Borough election results</span></a></li>
            <li class="current"><a href="/councillors-and-elections/elections/local-elections/borough-election-results/3-may-2018/"><span class="forceBlack">3 May 2018</span></a></li>
    </ul>

                            </div>
                            
                            <div class="form-group navbar-right" style="text-align:right">
                                <button id="btnOpenSearch" type="submit" style="padding-top:5px; padding-bottom:5px" aria-label="Search" title="Search Button" class="navbar-toggle collapse in">
                                    <span class="sr-only forceBlack">Search Button</span>
                                    <span class="glyphicon glyphicon-search forceBlack"></span>
                                </button>

                                <button id="btnA2Z" type="button" class="navbar-toggle collapse in" style="padding-top:5px; padding-bottom:5px">
                                    <span class="forceBlack">A - Z</span>
                                </button> 
                                
                                <button id="btnMenu" type="button" style="padding-top:5px; padding-bottom:5px" class="navbar-toggle collapse in">
                                    <span class="sr-only forceBlack">Toggle navigation</span>
                                    <span class="hidden-sm hidden-xs forceBlack">Menu</span>
                                    <span style="margin-top:4px;margin-bottom:4px" class="icon-bar hidden-lg hidden-md forceBlack"></span>
                                    <span style="margin-top:4px;margin-bottom:4px" class="icon-bar hidden-lg hidden-md forceBlack"></span>
                                    <span style="margin-top:4px;margin-bottom:4px" class="icon-bar hidden-lg hidden-md forceBlack"></span>
                                </button>
                            </div>
                    </div>
                </div>
                
                <div id="a2zPopout" class="popoutContainerAZ">
                    <script>

        $(document).ready(function () {
            $(".a2zItem").click(function (event) {
                event.preventDefault();
                GetA2ZItems($(this).children('a').text(), function(data){
                    populateA2Z(data);
                });
            });
        });
        
        function GetA2ZItems(firstLetter, callback) {
            $.ajax({
                url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/TaxonomyJSON.asmx/GetA2ZByFirstLetter',
                type: 'POST',
                data: {"firstLetter": firstLetter},
                dataType: 'json',
                success: function (data) {
                    callback(data);
                }
            });
            
        }
        
        function populateA2Z(data){
            var html1 = '';
            var html2 = '';
             $.each(data, function (index, value) {
                if(index < data.length / 2){
                    html1 += '<p class="a2zResult"><a href="' + data[index].url + '"';
                    if(data[index].ext != "0"){html1 += ' target="_blank"';}
                    html1 += '>' + data[index].term + '</a></p>';
                }
                else{
                    html2 += '<p class="a2zResult"><a href="' + data[index].url + '"';
                    if(data[index].ext != "0"){html2 += ' target="_blank"';}
                    html2 += '>' + data[index].term + '</a></p>';
                }
            });
            $("#a2zcol1").html(html1);
            $("#a2zcol2").html(html2);

        }
        
        function isEven(n) {
          return n == parseFloat(n)? !(n%2) : void 0;
        }
        
</script>

<div style="margin: 0 auto;">
    <div class="a2zmenu">
	    <div class="a2zItem" aria-label="Open A to Z items starting with A" tabindex="0"><a class="a2zLetter">A</a></div><div class="a2zItem" aria-label="Open A to Z items starting with B" tabindex="0"><a class="a2zLetter">B</a></div><div class="a2zItem" aria-label="Open A to Z items starting with C" tabindex="0"><a class="a2zLetter">C</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with D" tabindex="0"><a class="a2zLetter">D</a></div><div class="a2zItem" aria-label="Open A to Z items starting with E" tabindex="0"><a class="a2zLetter">E</a></div><div class="a2zItem" aria-label="Open A to Z items starting with F" tabindex="0"><a class="a2zLetter">F</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with G" tabindex="0"><a class="a2zLetter">G</a></div><div class="a2zItem" aria-label="Open A to Z items starting with H" tabindex="0"><a class="a2zLetter">H</a></div><div class="a2zItem" aria-label="Open A to Z items starting with I" tabindex="0"><a class="a2zLetter">I</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with J" tabindex="0"><a class="a2zLetter">J</a></div><div class="a2zItem" aria-label="Open A to Z items starting with K" tabindex="0"><a class="a2zLetter">K</a></div><div class="a2zItem" aria-label="Open A to Z items starting with L" tabindex="0"><a class="a2zLetter">L</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with M" tabindex="0"><a class="a2zLetter">M</a></div><div class="a2zItem" aria-label="Open A to Z items starting with N" tabindex="0"><a class="a2zLetter">N</a></div><div class="a2zItem" aria-label="Open A to Z items starting with O" tabindex="0"><a class="a2zLetter">O</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with P" tabindex="0"><a class="a2zLetter">P</a></div><div class="a2zItem" aria-label="Open A to Z items starting with Q" tabindex="0"><a class="a2zLetter">Q</a></div><div class="a2zItem" aria-label="Open A to Z items starting with R" tabindex="0"><a class="a2zLetter">R</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with S" tabindex="0"><a class="a2zLetter">S</a></div><div class="a2zItem" aria-label="Open A to Z items starting with T" tabindex="0"><a class="a2zLetter">T</a></div><div class="a2zItem" aria-label="Open A to Z items starting with U" tabindex="0"><a class="a2zLetter">U</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with V" tabindex="0"><a class="a2zLetter">V</a></div><div class="a2zItem" aria-label="Open A to Z items starting with W" tabindex="0"><a class="a2zLetter">W</a></div><div class="a2zItem" aria-label="Open A to Z items starting with X" tabindex="0"><a class="a2zLetter">X</a></div>
        <div class="a2zItem" aria-label="Open A to Z items starting with Y" tabindex="0"><a class="a2zLetter">Y</a></div><div class="a2zItem" aria-label="Open A to Z items starting with Z" tabindex="0"><a class="a2zLetter">Z</a></div>
    </div>
    <br class="brclear" />
    <div class="a2zResultContainer">
        <div id="a2zcol1" class="col-sm-6">
        </div>
        <div id="a2zcol2" class="col-sm-6">
        </div>
    </div>
</div>
                </div>                
                <div id="menuPopout" class="popoutContainerMenu">
                        <div class="topLevelBackground">

        <div class="row">
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/benefits" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Benefits
                    </span>                       
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/business" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Business
                    </span> 
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/community" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Community
                    </span> 
                </a>
            </div>

            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/council" class="tmlink">
            		<span aria-hidden="true" class="tmchevron">
            	        >
                    </span>
                    <span class="tmtext">
                        Council
                    </span>
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/council-tax" class="tmlink">
                	<span aria-hidden="true" class="tmchevron">
            	        >
                    </span>
                    <span class="tmtext">
                        Council tax
                    </span>
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/councillors-and-elections" class="tmlink">
            		<span aria-hidden="true" class="tmchevron">
        		        >
                    </span>   
                    <span class="tmtext">
                        Councillors and elections
                    </span>             
                </a>
            </div>    
    

            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/environment" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Environment
                    </span>                       
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/housing" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Housing
                    </span> 
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/licensing" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Licensing
                    </span> 
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/planning" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Planning
                    </span> 
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/roads-and-parking" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Roads and parking
                    </span> 
                </a>
            </div>
            <div class="col-sm-6 col-md-4 tmitem">
                <a href="/rubbish-waste-and-recycling" class="tmlink">
                    <span aria-hidden="true" class="tmchevron">
        		        >
                    </span> 
                    <span class="tmtext">
                        Rubbish, waste and recycling
                    </span> 
                </a>
            </div>            
        </div>
    
    </div>
                </div>            
                <div id="searchPopout" class="popoutContainerSearch">
                    <script>

    var imgAltTagsFix = function() {
        //customSearchControl.setSearchCompleteCallback(this,function(){ alert("search completed");});
        //google.load("search", "1", {"callback" : onLoadCallback});
        //console.log("hello" + $('.gsc-adBlock'));
        $('.gsc-adBlock').hide();
        $('img.gsc-branding-img').attr("alt", "Google Custom Search Branding");
        $('input.gsc-search-button').attr('alt', "Google Custom Search Button");
        $('.gsc-thumbnail-inside').css("padding", "0");
        
        $('table.gstl_50').attr('role', "presentation");
        $('table.gstl_50').removeAttr('cellpadding');
        $('table.gstl_50').removeAttr('cellspacing');
        $('table.gstl_50').attr('style', "padding:0;");   
        
        $('table.gsc-above-wrapper-area-container').attr('role', "presentation");
        $('table.gsc-above-wrapper-area-container').removeAttr('cellpadding');
        $('table.gsc-above-wrapper-area-container').removeAttr('cellspacing');
        $('table.gsc-above-wrapper-area-container').attr('style', "padding:0;");
        
        $('table.gsc-resultsHeader').attr('role', "presentation");
        $('table.gsc-resultsHeader').removeAttr('cellpadding');
        $('table.gsc-resultsHeader').removeAttr('cellspacing');
        $('table.gsc-resultsHeader').attr('style', "padding:0;");
        
        $('table.gsc-search-box').attr('role', "presentation");
        $('table.gsc-search-box').removeAttr('cellpadding');
        $('table.gsc-search-box').removeAttr('cellspacing');
        $('table.gsc-search-box').attr('style', "padding:0;");
        $('table.gsc-search-box').attr('title', "Site Search");
        
        //$('td.gsc-search-button').html('<button type="button" class="gsc-search-button gsc-search-button-v2">search</button>');

    };
    
    function onLoadCallback(){
        //console.log("hello2" + $('.gsc-adBlock'));
    }
    
    window.__gcse = {
        callback: imgAltTagsFix
    };

    (function() {
        var cx = '011253090859162375191:mzr5uftn9hu';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
    })();
    
</script>

    <div style="margin: 0 auto;">
        <div class="gcse-search"></div>
    </div>
                </div> 
                
            </nav>
        </div>
        
        


    <div class="container">
        <div class="row row-fluid">
        
            <div class="col-md-9 col-md-push-3">

                    <div>
        <h1>3 May 2018
        </h1>
    </div>
            
                <div class="bodyText">
                    
                    <script>
        var electionId = 9;
        //console.log(electionId);
        var colType = "rightCol";
        var myHtml = '';
        var grandTotalElectorate = 0;
        var grandTotalVotes = 0; 
        var electionAreasM = [];
    
        $(document).ready(function () {
        
            GetTotalVoidPapersForArea("11","43", function(){
            });

			GetAllElectionAreaForElection(electionId, function(electionAreas){
				//var totalVotes = 0;
				electionAreasM = electionAreas;
				console.log(electionAreasM);
				electionAreas.forEach(function (listItem, index) {
                    
    				AddTableToDiv("listOfCandidates" + listItem.areaInElectionId, listItem.areaName, function(){
    				});
					
				});
			})
			
			$("#resultsContainer").html($("#resultsContainer").html() + myHtml);
			//check if row end div missing i.e. odd number of areas
			//if so add another </div> to close final row
			//if($("#resultsContainer").html().endsWith("</div></div>")){
			if($("#resultsContainer").html().lastIndexOf('</div></div>') == $("#resultsContainer").html().length - '</div></div>'.length){
			    $("#resultsContainer").html($("#resultsContainer").html() + '</div>');
			}
			
            GetAllElectionAreaForElection(electionId, function(electionAreas){
				electionAreas.forEach(function (listItem, index) {
				    grandTotalElectorate += listItem.electorate * 1;
    				GetListOfCandidates(listItem.electionId, listItem.areaInElectionId, listItem.electorate);
    				//$(".row").css('height', 'auto');
				});
			})
        });

		function GetLatestElection(callback) {
			$.ajax({
				url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetLatestElection',
				dataType: 'json',
				cache: false,
				success: function (latestElection) {
				        	//console.log(latestElection);

					callback(latestElection);
				}
			});
		}

		function GetAllElectionAreaForElection(electionId, callback) {
			$.ajax({
				url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetAllElectionAreaForElection',
				dataType: 'json',
				cache: false,
				async: false,
				data: { "electionId": electionId },
				success: function (electionAreas) {
					callback(electionAreas);
				}
			});
		}

		function GetElectionArea(areaInElectionId, callback) {
			$.ajax({
				url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetElectionArea',
				dataType: 'json',
				cache: false,
				async: true,
				data: { "areaInElectionId": areaInElectionId },
				success: function (electionArea) {
					callback(electionArea);
				}
			});
		}
		
        function GetListOfCandidates(electionId, areaInElectionId, electorate) {
            $.ajax({
                url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetElectionCandidatesForElectionArea',
                data: { "electionId": electionId , "areaInElectionId": areaInElectionId },
                dataType: 'json',
                cache: false,
                //async: false,
                success: function (listOfCandidates) {
                	var votesTotal = 0;
                	listOfCandidates.forEach(function (listItem, index) {
                		votesTotal = votesTotal + 1*listItem.votes
					});
					GetTotalVoidPapersForArea(electionId, areaInElectionId, function(voidPapers){
    					listOfCandidates.push({"lastName": "Spoilt", "firstName": "papers", "party": "", "votes": voidPapers });
                        //console.log(listOfCandidates);
                        $('#listOfCandidates' + areaInElectionId).DataTable({
                            "data": listOfCandidates,
                            "deferRender": true,
                            "destroy": true,
                            "paging": false,
                            "ordering": false,
                            "filter": false,
                            "info": false,
                            "columns": [
                                {
                                    "data": "candidateName",
                                    mRender: function (data, type, row) {
    									return row.lastName + ' ' + row.firstName;
    
                                    }
                                },
                                {
                                    "data": "party",
                                    mRender: function (data, type, row) {
                                        return row.party;
                                    }
                                },
                                {
                                    "data": "votes",
                                    mRender: function (data, type, row) {
    									if(row.elected == "True" ){
    										return row.votes + ' (E)';
    									}
    									else{
    										return row.votes;
    									}
                                    }
                                }
    
                            ],
                            "initComplete": function (settings, json) {
                            
                            },
                            "footerCallback": function ( row, data, start, end, display ) {
    							// Update footer
    							var intVal = function ( i ) {
    								return typeof i === 'string' ?
    									i.replace(/[\Â£,]/g, '')*1 :
    									typeof i === 'number' ?
    										i : 0;
    							};
    							var votesTotal = 0;
    							var turnout = 0
    
    							for(c = start;c < end; c++){
    								if(!isNaN(intVal(data[display[c]].votes))){
    									votesTotal += intVal(data[display[c]].votes);
    								}
    							}
    							if(electorate != 0){
    							    turnout = (votesTotal / electorate * 100).toFixed(0) + '%'
    							}
    							grandTotalVotes += votesTotal;
    							//console.log(grandTotalVotes);
    							//console.log(grandTotalElectorate);
    							console.log(voidPapers);
    							grandTotalVotes += voidPapers;
    							if(grandTotalElectorate != 0){
    							    //$('#totalsContainer').html('<strong>Overall votes cast: ' + grandTotalVotes + '.&nbsp;  Overall turnout: ' + (grandTotalVotes/grandTotalElectorate * 100).toFixed(0) + '%</strong><br /><br /><br />');
    							}
    							
    							var api = this.api(), data;
    							
    							var areaElectorate = 0;
    							electionAreasM.forEach(function (listItem, index) {
                                    if(listItem.areaInElectionId == areaInElectionId){
                                     areaElectorate = listItem.electorate;
                					}
                				});
    							GetListOfPollingStations(electionId, areaInElectionId, function(veriTotal){
    							    //console.log("veriTotal");
    							    //console.log(veriTotal);
    							    GetPostalBoxesForArea(electionId, areaInElectionId, function(postalVeriTotal){
            							console.log("veriTotal");
    							        console.log(veriTotal + postalVeriTotal);
    							        console.log(areaElectorate);
    							        var grandTotalVotes = veriTotal + postalVeriTotal;
    							        //if(grandTotalElectorate != 0){
            							//    $('#totalsContainer').html('<strong>Overall votes cast: ' + grandTotalVotes + '.&nbsp;  Overall turnout: ' + (grandTotalVotes/areaElectorate * 100).toFixed(0) + '%</strong><br /><br /><br />');
            							//}
            							GetTotalVoidPapersForArea(electionId, areaInElectionId, function(totalVoidForArea){
        							        var turnout = (grandTotalVotes/areaElectorate * 100).toFixed(0) + '%'
    
        							        if(electionId != 10000){
                              					
                    							$( api.column( 0 ).footer() ).html(
                    								'% Turnout'
                    							);
                    							$( api.column( 1 ).footer() ).html(
                                                    //turnout
                    							);
                    							$( api.column( 2 ).footer() ).html(
                    								//areaElectorate
                    								turnout
                    							);
                							}
                							
                						});
            						});
    							})
    						}
                        });
                    
                    });
                }
            });
        }
        
        function GetListOfPollingStations(electionId, areaInElectionId, callback) {
            var bpaTotal = 0;
            var veriTotal = 0;
            $.ajax({
                url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetPollingStationsForArea',
                data: { "electionId": electionId , "areaInElectionId": areaInElectionId },
                dataType: 'json',
                cache: false,
                success: function (listOfPollingStations) {
                	var bpaTotal = 0;
                	var veriTotal = 0;
                	listOfPollingStations.forEach(function (listItem, index) {
                		bpaTotal = bpaTotal + 1*listItem.bPA
                		veriTotal = veriTotal + 1*listItem.verification
					});
					callback(veriTotal);
				}
			});
		}

        function GetPostalBoxesForArea(electionId, areaInElectionId, callback) {
            console.log(areaInElectionId);
            $.ajax({
                url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetPostalBoxesForArea',
                dataType: 'json',
                cache: false,
				data: { "electionId": electionId , "areaInElectionId": areaInElectionId },
                success: function (postalBoxes) {
                var veriTotal = 0;
                	var postalBpaTotal = 0;
					var postalVeriTotal = 0;
					postalBoxes.forEach(function (listItem, index) {
						postalBpaTotal = postalBpaTotal + 1*listItem.accountFinalTotal
						postalVeriTotal = postalVeriTotal + 1*listItem.veriFinalTotal
					});

                    callback(postalVeriTotal);
                }
            });
        }

        function GetTotalVoidPapersForArea(electionId, areaInElectionId, callback) {
            //console.log(areaInElectionId);
            $.ajax({
                url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ElectionsJSON.asmx/GetTotalVoidPapersForArea',
                dataType: 'json',
                cache: false,
				data: { "electionId": electionId , "areaInElectionId": areaInElectionId },
                success: function (totalVoidForArea) {
                    console.log(totalVoidForArea.voidPapers);
                    callback(totalVoidForArea.voidPapers);
                }
            });
        }


        function AddTableToDiv(id, areaName, callback) {
            if(colType == "rightCol"){
				colType = "leftCol";
			}
			else{
				colType = "rightCol";
			}
            if(colType == 'leftCol'){
                myHtml += '<div class="row">';
     	    }
  	        myHtml += '<div class="col-sm-6">';
 			myHtml += '<div class="tableContainer" style="height:auto;">';
			myHtml += '	<h4>' + areaName + '</h4>';
			myHtml += '	<table id="' + id + '" class="table table-striped table-bordered">';
			myHtml += '		<thead>';
			myHtml += '			<tr>';
			myHtml += '				<th style="width:60%">Name</th>';
			myHtml += '				<th style="width:20%">Party</th>';
			myHtml += '				<th style="width:20%">Votes</th>';
			myHtml += '			</tr>';
			myHtml += '		</thead>';
			myHtml += '		<tfoot>';
			myHtml += '		<th></th>';
			myHtml += '		<th></th>';
			myHtml += '		<th></th>';
			myHtml += '		<tfoot>';
			myHtml += '		</tfoot>';
			myHtml += '	</table>';
			myHtml += '</div>';
            myHtml += '</div>';
            //console.log(colType);
            if(colType == 'rightCol'){
                
                myHtml += '</div><br class="brclear" />';
     	    }
            //console.log(myHtml);
            callback();
        }

    </script>

    <style>
        .snum {
            float:left;
            border:1px solid blue;
            padding:3px;
            font-size:1em;
            height:30px;
            width:40px;
        }
        .sname {
            float:left;
            border:1px solid blue;
            padding:3px;
            font-size:1em;
            white-space: nowrap;
            overflow: hidden;
            height:30px;
            width:450px;
        }
        .bpa {
            float:left;
            border:1px solid blue;
            padding:3px;
            font-size:1em;
            height:30px;
            width:40px;
       }
		.brclear{
			clear:both;
			height:0;
			margin:0;
			line-height: 0;
		}
		.item{
			margin-top: 5px;
		}
		.textBoxInput{
			width: 40px;
			height: 30px;
		}

		input{
			width: 60px;
			text-align: right;
		}
		td{
			text-align: left;
		}

		.tableContainer{
			height:280px;
		}


		@media print {
            .noPrint {
                display: none;
            }

            a[href]:after {
                content: none !important;
            }

            .tableContainer{
            	page-break-inside: avoid;
            	height:auto;
            }

            /*
            .pageBreak {
                page-break-before: always;
            }
            */
        }
    </style>


	 <div id="resultsContainer">

  	 </div>
  	 
	 <div id="totalsContainer">

  	 </div>

                    <div class="lgLinkContainer">
                        


                    </div>
                    
                    <div class="furtherHelp">Need further help or information?</div>
                    <p>Contact the team directly on 01773 841458 or email <a href="mailto:elections@ambervalley.gov.uk">elections@ambervalley.gov.uk</a></p>

                </div>
          
            </div>

            <div class="col-md-3 col-md-pull-9">

                <div class="hidden-sm hidden-lg hidden-md">
                    

                

                </div>
                    <div class="sideNavigation  hidden-print">
        <span class="list-group-item list-group-header">Navigation menu</span>
            <a href="/" class="list-group-item list-group-item-action"><span aria-hidden="true">&lt; </span>Back to Home</a>
            <a href="/councillors-and-elections/" class="list-group-item list-group-item-action"><span aria-hidden="true">&lt; </span>Back to Councillors and elections</a>
            <a href="/councillors-and-elections/elections/" class="list-group-item list-group-item-action"><span aria-hidden="true">&lt; </span>Back to Elections</a>
            <a href="/councillors-and-elections/elections/local-elections/" class="list-group-item list-group-item-action"><span aria-hidden="true">&lt; </span>Back to Local elections</a>
            <a href="/councillors-and-elections/elections/local-elections/borough-election-results/" class="list-group-item list-group-item-action"><span aria-hidden="true">&lt; </span>Back to Borough election results</a>
    </div>
                
                <div class="hidden-xs">
                    

                

                </div>
                    
            </div>

        </div>
    </div>

        <footer class="footer .hidden-print">
            <div class="container">
                <div class="row">

<script>
    $(document).ready(function () {
        $('.feedbackOption').on('click', function(){
            //console.log($(this).data
            $("#feedbackOption").val($(this).data("option"));
            console.log(window.location.pathname);
            $(".feedbackInitiallyHidden").show();
        });
        $('#rateThisPage').on('click', openFeedbackDlg);
        $('#btnSubmitFeedback').on('click', submitPageFeedback);
    })
 
    function openFeedbackDlg(){
        $('#dlgFeedback').modal('show');
    }

    function submitPageFeedback() {
        console.log("submit page feedback");
        var data = {};
        data['pageUrl'] = window.location.pathname;
        data['rating'] = $('#feedbackOption').val();
        data['pageName'] = "";
        data['comments'] = $('#feedbackExplanation').val();
        data['personName'] = "";
        data['personAddress'] = "";
        data['personEmail'] = $('#feedbackEmail').val();
        data['personTelNum'] = "";

        $.ajax({
            url: 'https://info.ambervalley.gov.uk/WebServices/AVBCFeeds/ComplaintsJSON.asmx/SubmitPageFeedback',
            type: 'POST',
            data: {
                "data": JSON.stringify(data)
            },
            dataType: 'json',
            success: function (rdata) {
                console.log(rdata)
                //callback(rdata);
            }
            //error: function(xhr, ajaxOptions, thrownError) {
            //    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            //}
        });

    }

</script>

 <div class="hidden-print">
     
    <div class="col-xs-6 col-sm-3">
        <div class="subHeading">Contact us</div>
        <ul>
            <li>
                <a href="/contact-us/">How to get in touch</a>
            </li>
            <li>
                <a href="#" id="rateThisPage">Rate this page</a>
            </li>
        </ul>   
    </div> 
    
    <div class="col-xs-6 col-sm-3">
        <div class="subHeading">Corporate</div>
        <ul>
            <li>
                <a href="/our-website/accessibility/">Accessibility</a>
            </li>
            <li>
                <a href="/council/data-protection/">Data protection</a>
            </li>
            <li>
                <a href="/our-website/">Our website</a>
            </li>    
            <li>
                <a href="/council/budgets-and-spending/transparency/">Transparency</a>
            </li>             
        </ul>
    </div> 
    
    <div class="col-xs-6 col-sm-3">
        <div class="subHeading">News</div>
        <ul>
            <li>
                <a href="/council/news/">News releases</a>
            </li>
            <li>
                <a href="/council/public-notices/">Public notices</a>
            </li>
        </ul>
        <br/>
        <a href="https://twitter.com/AmberValleyBC" target="_blank"><img src="/images/twitter_logo.png" alt="Twitter" style="width: 30px; height: 30px;" /></a>
        <a href="http://www.facebook.com/AmberValleyBC" target="_blank"><img src="/images/facebook_logo.png" alt="Facebook" style="margin-left: 5px; width: 30px; height: 30px;" /></a>
    </div>
     
    <div class="col-xs-6 col-sm-3">
        <div class="subHeading">Login</div>
        <ul>
            <li>
                <a href="/councillors-area/">Councillor's area</a>
            </li>
        </ul>
        <ul>
        </ul>
    </div>
    
</div>

    <div id="dlgFeedback" class="modal fade" role="dialog">
		<div class="modal-dialog" id="dlgModalFeedback">
			<div class="modal-content">
				<div class="modal-header" style="color: #FFFFFF; background-color:#008080;">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<p class="modal-title" style="color: #FFFFFF !important;background-color:#008080;text-align:center !important">Page feedback</p>
				</div>
				<div class="modal-body">
					<div id="pnlFeedback">
						<div class="dataListContainer">
							<div class="dataItemRow">
							    <p>Did this page help you with your query or service request?</p>
                                <div class="feedbackChoice">
                                    <div class="feedbackOption" data-option="Good"><img src="/images/feedbackGood.jpg" width="60" height="60" alt="Page Feedback Good" /><p>Yes</p></div>
                                    <div class="feedbackOption" data-option="Partial"><img src="/images/feedbackNeutral.jpg" width="60" height="60" alt="Page Feedback Neutral" /><p>Partially</p></div>
                                    <div class="feedbackOption" data-option="Poor"><img src="/images/feedbackPoor.jpg" width="60" height="60" alt="Page Feedback Poor" /><p>No</p></div>
                                </div>	
                                <input type="hidden" id="feedbackOption" name="feedbackOption" aria-hidden="true" />
                            </div>
 							<div class="dataItemRow feedbackInitiallyHidden">	
								<p><label for="feedbackExplanation">To help us improve our site please give a brief explanation of your rating:</label></p>
								<textarea id="feedbackExplanation" style="width:100%" rows="5"></textarea>									 
							</div>
							<div class="dataItemRow feedbackInitiallyHidden">
								 <p><label for="feedbackEmail">Email address:</label></p>
								 <input type="text" id="feedbackEmail" style="width:100%" />
							</div>
							<div class="dataItemRow feedbackInitiallyHidden">
							    <p>If you have a general comment or complaint about the council's services, please visit our 
							    <a href="/council/comments-and-complaints/comments-and-compliments/">comments</a> or <a href="/council/comments-and-complaints/complaints/">complaints</a> page.</p>
							</div>
                        </div>
					</div>
				</div>
				<div class="modal-footer feedbackInitiallyHidden">
					<button type="button" class="btn btn-default" data-dismiss="modal" id="btnSubmitFeedback">Submit</button>
				</div>
			</div>
		</div>
	</div>



                </div>
                <div class="row">
		            <div class="copyright">&copy; Amber Valley Borough Council 2019</div>
                </div>
            </div>
        </footer>
        
        <script>
            $(document).ready(function () {
                $('select option').filter(function() {
                    return !this.value || $.trim(this.value).length == 0 ;
                }).text("Please select");
                
                $(".umbraco-forms-form * input[type=text]").each(function(){
                    if($('label[for="' + $(this).attr('name') + '"]').length == 0 && !$(this).attr('title')){
                        !$(this).attr('title', 'hidden system field - please ignore');
                        !$(this).attr('aria-hidden', 'true');
                    }
                });
                $('a[title="View Fullscreen"]').html("-");
                $('a[title="Layers"]').html("-");
                //console.log($(".umbraco-forms-form * input[type=checkbox]").parent().parent());
                //$(".umbraco-forms-form * input[type=checkbox]").parent().parent().css("float", "left !important");
                //$(".umbraco-forms-form * input[type=checkbox]").parent().css("border", "1px solid blue");
                //$(".umbraco-forms-form * input[type=checkbox]").parent().css("height", "30");
            });
        </script>
    </body>

</html>
